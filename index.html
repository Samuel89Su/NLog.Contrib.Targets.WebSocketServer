<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Nlog.Contrib.Targets.Websocketserver by vtortola</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Nlog.Contrib.Targets.Websocketserver</h1>
      <h2 class="project-tagline">NLog target that setups a standalone WebSocket server and broadcasts the log entries.</h2>
      <a href="https://github.com/vtortola/NLog.Contrib.Targets.WebSocketServer" class="btn">View on GitHub</a>
      <a href="https://github.com/vtortola/NLog.Contrib.Targets.WebSocketServer/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/vtortola/NLog.Contrib.Targets.WebSocketServer/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="nlogtargetswebsocketserver" class="anchor" href="#nlogtargetswebsocketserver" aria-hidden="true"><span class="octicon octicon-link"></span></a>NLog.Contrib.Targets.WebSocketServer</h1>

<p>Broadcast your servers´ logs to websocket connections in real-time with minimal effort. Subscribe to a regular expressions to remove undesired lines. Simplifies log monitoring, allowing that a simple web browser to watch over multiple servers´ logs interpolating the lines by timestamp. Not a replacement of a proper monitoring tool, but handy for watching over logs with little logistic effort.</p>

<p>NLog.Contrib.Targets.WebSocketServer is a <a href="https://github.com/nlog/nlog/wiki/Targets">NLog target</a> that instead of writing on a file, or showing the log on the console, broadcast the log entries to the connected websocket connections.</p>

<p>Features:</p>

<ul>
<li>
<strong>Fully integrated with NLog</strong>: it does not require changes in your application code beyond the configuration.</li>
<li>
<strong>Self-hosted</strong>: it does not need IIS or any hosting framework, <a href="http://vtortola.github.io/WebSocketListener/">WebSocketListener</a> is socket based.</li>
<li>
<strong>Mono compatible</strong>: Both NLog and WebSocketListener are compatible with Mono.</li>
<li>
<strong>Subscribe to Regular Expressions</strong>: Is it possible to send a message throug the WebSocket connection to indicate the expression to which you want to subscribe. Only log entries matching that regex will be sent.</li>
<li>
<strong>Scalable</strong>: NLog and WebSocketListener components are decoupled by a <a href="http://www.ni.com/white-paper/3023/en/">producer-consumer pattern</a>, so NLog will append the log entries to <code>WebSocketServerTarget</code> in <code>O(1)</code> time always, and another thread/threads are responsible of distributing that log entry to the clients. Still, if the component has a big number of connected clients, it may interfere with your application performance. See the <code>MaxConnectedClients</code> configuration setting.</li>
</ul>

<p><a href="//github.com/vtortola/NLog.Contrib.Targets.WebSocketServer/wiki/WebSocket-log-viewer-UI-example-with-AngularJS">Checkout this example of a log viewer done in AngularJS</a>. </p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a id="nuget" class="anchor" href="#nuget" aria-hidden="true"><span class="octicon octicon-link"></span></a>NuGet</h3>

<pre><code>PM&gt; Install-Package NLog.Contrib.Targets.WebSocketServer
</code></pre>

<h2>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h2>

<p>Configure <code>NLog.Contrib.Targets.WebsocketServer</code> as a new target.</p>

<h4>
<a id="required-configuration-parameters" class="anchor" href="#required-configuration-parameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Required configuration parameters:</h4>

<ul>
<li>
<code>Port (Int32)</code> : Indicates in which connection will the WebSocket server listen for new connections.</li>
</ul>

<h4>
<a id="optional-configuation-parameters" class="anchor" href="#optional-configuation-parameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optional configuation parameters:</h4>

<ul>
<li>
<code>IPAddressStartsWith (String)</code>: Indicates how the client IP address must start to be accepted. Loopback interface is always accepted. A example value would be <code>192.168.</code>. An empty string means that all connections are accepted.</li>
<li>
<code>ThrowExceptionIfSetupFails (Boolean)</code>: By default <code>NLog.Contrib.Targets.WebSocketServerTarget</code> will fail silently if does not succeed trying to set up the websocket server (e.g.: because the port is already in use), and it will be automatically disabled. In production you may not want the application to crash because one of your targets failed, but during development you would like to get an exception indicatig the issue. </li>
<li>
<code>MaxConnectedClients (Int32)</code>: The maximum number of allowed connections. By default 100.</li>
<li>
<code>ClientTimeOut (TimeSpan)</code>: The amount of time without client <a href="https://tools.ietf.org/html/rfc6455#section-5.5.2">pong responses</a>. By default 10 seconds.</li>
</ul>

<div class="highlight highlight-xml"><pre>  &lt;<span class="pl-ent">nlog</span>&gt;
    <span class="pl-c">&lt;!-- This part is only required for NLog versions &lt; 4.0  --&gt;</span>
    &lt;<span class="pl-ent">extensions</span>&gt;
      &lt;<span class="pl-ent">add</span> <span class="pl-e">assembly</span>=<span class="pl-s"><span class="pl-pds">"</span>NLog.Contrib.Targets.WebsocketServer<span class="pl-pds">"</span></span>/&gt;
    &lt;/<span class="pl-ent">extensions</span>&gt;

    &lt;<span class="pl-ent">targets</span>&gt;
      &lt;<span class="pl-ent">target</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>Console<span class="pl-pds">"</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>consolelog<span class="pl-pds">"</span></span> /&gt;
      &lt;<span class="pl-ent">target</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>logfile<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>File<span class="pl-pds">"</span></span> <span class="pl-e">fileName</span>=<span class="pl-s"><span class="pl-pds">"</span>file.txt<span class="pl-pds">"</span></span> /&gt;

      <span class="pl-c">&lt;!-- Configuration for NLog.Targets.WebSocketServer --&gt;</span>
      &lt;<span class="pl-ent">target</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>websocket<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>NLog.Contrib.Targets.WebsocketServer<span class="pl-pds">"</span></span> <span class="pl-e">port</span>=<span class="pl-s"><span class="pl-pds">"</span>9001<span class="pl-pds">"</span></span>/&gt;
    &lt;/<span class="pl-ent">targets</span>&gt;
    &lt;<span class="pl-ent">rules</span>&gt;
      &lt;<span class="pl-ent">logger</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> <span class="pl-e">minlevel</span>=<span class="pl-s"><span class="pl-pds">"</span>Trace<span class="pl-pds">"</span></span> <span class="pl-e">writeTo</span>=<span class="pl-s"><span class="pl-pds">"</span>logfile, websocket, consolelog<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">rules</span>&gt;
  &lt;/<span class="pl-ent">nlog</span>&gt;</pre></div>

<h2>
<a id="output" class="anchor" href="#output" aria-hidden="true"><span class="octicon octicon-link"></span></a>Output</h2>

<p>The WebSocket server broadcast JSON objects like this:</p>

<div class="highlight highlight-json"><pre>{
   <span class="pl-s"><span class="pl-pds">"</span>Timestamp<span class="pl-pds">"</span></span>:<span class="pl-c1">2015071602553825</span>,
   <span class="pl-s"><span class="pl-pds">"</span>Line<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>2015-07-16 21:55:38.2576|INFO||This is information.<span class="pl-pds">"</span></span>
}</pre></div>

<ul>
<li>
<code>Timestamp</code>: Is the server date and time in <code>yyyyMMddHHmmssff</code> format.</li>
<li>
<code>Line</code> : The actual formated log entry.</li>
</ul>

<h2>
<a id="input" class="anchor" href="#input" aria-hidden="true"><span class="octicon octicon-link"></span></a>Input</h2>

<p>The component accepts JSON commands to request special behaviours.</p>

<h4>
<a id="filter-by-regular-expression" class="anchor" href="#filter-by-regular-expression" aria-hidden="true"><span class="octicon octicon-link"></span></a>Filter by Regular Expression</h4>

<p>Instructs the component to only send the lines that match a give Regular Expression. Send an empty or null expression to reset it.</p>

<div class="highlight highlight-json"><pre>{
   <span class="pl-s"><span class="pl-pds">"</span>command<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>filter<span class="pl-pds">"</span></span>,
   <span class="pl-s"><span class="pl-pds">"</span>filter<span class="pl-pds">"</span></span>: <span class="pl-ii">&lt;RegEx&gt;</span>
}</pre></div>

<h3>
<a id="links" class="anchor" href="#links" aria-hidden="true"><span class="octicon octicon-link"></span></a>Links</h3>

<ul>
<li><a href="//github.com/nlog/nlog/wiki/Extending%20NLog">Extending NLog</a></li>
<li><a href="//vtortola.github.io/WebSocketListener/">WebSocketListener</a></li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/vtortola/NLog.Contrib.Targets.WebSocketServer">Nlog.contrib.targets.websocketserver</a> is maintained by <a href="https://github.com/vtortola">vtortola</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-53263543-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>

